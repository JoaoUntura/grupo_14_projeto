<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gerenciar Clientes</title>
    <link rel="stylesheet" href="../css/bootstrap.min.css">
    <link rel="stylesheet" href="../css/personalizado.css">
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="d-flex">
      
      <%- include('partials/sidebar', { user: user }) %>
      
      <div class="pagina-conteudo">
        <%- include('partials/logout') %>

        <div class="main-card-wrapper">
          
          <h2 class="page-title">Gerenciar Clientes</h2>
          
          <div class="content-card">
            
            <h4 class="card-title-header">Lista de Clientes Cadastrados</h4>

            <div class="mb-3">
                <a href="/clientes/cadastro" class="secondary-button custom-button">Novo Cadastro</a>
            </div>

            <% 
                // Dados simulados para o back-end
                const clientes_mock = [
                    { id: 1, nome: "Matheus", contato: "19981175958" },
                    { id: 2, nome: "Ana Clara", contato: "11995432100" },
                    { id: 3, nome: "Pedro Rocha", contato: "21987654321" }
                ];
            %>
            <% if (clientes_mock && clientes_mock.length > 0) { %>
                <div class="table-responsive">
                    <table class="table table-striped custom-table align-middle">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Nome</th>
                                <th>Contato</th>
                                <th>Ações</th> </tr>
                        </thead>
                        <tbody>
                            <% clientes_mock.forEach(cliente => { %>
                                <tr data-cliente-id="<%= cliente.id %>">
                                    <td><%= cliente.id %></td>
                                    <td><%= cliente.nome %></td>
                                    <td><%= cliente.contato %></td>
                                    <td>
                                        <button class="btn btn-sm custom-button secondary-button btn-edit-cliente">Editar</button>
                                        <button class="btn btn-sm custom-button btn-danger btn-delete-cliente">Excluir</button>
                                    </td>
                                </tr>
                            <% }) %>
                        </tbody>
                    </table>
                </div>
            <% } else { %>
                <p class="text-muted">Nenhum cliente cadastrado ainda.</p>
            <% } %>

          </div>
        </div>
      </div>
    </div>

    <script>
        // Simulação de ações (Editar/Excluir) - Seu amigo irá substituir por chamadas de API
        document.querySelectorAll('.btn-edit-cliente').forEach(button => {
            button.addEventListener('click', (e) => {
                const clienteId = e.target.closest('tr').dataset.clienteId;
                console.log(`Editar Cliente ${clienteId}`);
                alert(`Simulação: Redirecionar para página de edição do Cliente ${clienteId}`);
                // Geralmente redireciona para /clientes/editar/1
            });
        });

        document.querySelectorAll('.btn-delete-cliente').forEach(button => {
            button.addEventListener('click', (e) => {
                const row = e.target.closest('tr');
                const clienteId = row.dataset.clienteId;
                if (confirm(`Tem certeza que deseja excluir o Cliente ${clienteId}?`)) {
                    console.log(`Excluir Cliente ${clienteId}`);
                    // AQUI: Chamar a API DELETE (ex: DELETE /api/clientes/1)
                    row.remove(); // Simula a exclusão no front-end
                }
            });
        });
    </script>
    <script src="../js/bootstrap.bundle.min.js"></script>
    <script src="renderer.js"></script>
  </body>
</html>